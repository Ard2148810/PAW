<div *ngIf="boardReady" class="board">
  <div class="header-basic menu-container">
    <div class="menu-item">
      <span>BOARD:</span>
      <app-inline-input [value]=getBoardDisplayName() (valueChanged)="handleRenameBoard($event)"></app-inline-input>
    </div>
    <div style="margin-left: 50px">
      <span>MEMBERS:</span>
    </div>
    <div class="menu-item member-list" *ngFor="let member of data.teamMembers">
      <div class="dropdown">
        <button class="btn member">{{member}}</button>
        <div class="dropdown-content">
          <a class="dropdown-item" (click)="deleteUserFromBoard(member)">Remove user</a>
        </div>
      </div>
    </div>
    <div class="menu-item right-align">
      <div>
        <button class="btn simple" (click)="toggleAddingUserModal()">Add user</button>
      </div>
      <div>
        <button class="btn simple" (click)="toggleMakingPublicModal()">Make public</button>
      </div>
      <div>
        <button class="btn simple" (click)="toggleDeletingBoardModal()">Delete Board</button>
      </div>
      <div>
        <button class="btn simple" (click)="navigateBack()">Back</button>
      </div>
    </div>
  </div>
  <div id="content">
    <div class="list-container">
      <app-list
        *ngFor="let list of data.lists"
        [id]="list.id" [title]="list.name"
        [cards]="list.cards"
        (cardClicked)="handleCardClicked($event)"
        (cardAdded)="handleCardAdded($event)"
        (contentUpdated)="handleContentUpdated()"
      ></app-list>
      <app-list wildcard=true (listAdded)="handleListAdded($event)"></app-list>
    </div>
  </div>
</div>


<div *ngIf="addingUser" class="modal">
  <div class="modal-background">
    <div class="modal-window">
      <div class="modal-header">
        Choose user that you want to add to the board.
      </div>
      <div class="modal-body">
        <div class="form-control-container">
          <label for="userToAdd">
            username
          </label>
          <input id="userToAdd" type="text" #userToAdd>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn" (click)="toggleAddingUserModal()">Cancel</button>
        <button type="submit" (click)="addUserToBoard(userToAdd.value)" class="btn primary">Confirm</button>
      </div>
    </div>
  </div>
</div>


<div *ngIf="makingPublic" class="modal">
  <div class="modal-background">
    <div class="modal-window">
      <div class="modal-header">
        {{makingPublicMessage}}
      </div>
      <div class="modal-body">
        <div class="form-control-container">
          <span *ngIf="data.isPublic">Link: {{publicLink}}</span>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn" (click)="toggleMakingPublicModal()">Close</button>
        <button type="submit" (click)="makePublic()" class="btn primary" *ngIf="!data.isPublic">Confirm</button>
      </div>
    </div>
  </div>
</div>


<div *ngIf="deletingBoard" class="modal">
  <div class="modal-background">
    <div class="modal-window">
      <div class="modal-header">
        Are you sure you want to delete this board?
      </div>
      <div class="modal-body">
        <div class="form-control-container">
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn" (click)="toggleDeletingBoardModal()">Cancel</button>
        <button type="submit" (click)="deleteBoard()" class="btn primary">Confirm</button>
      </div>
    </div>
  </div>
</div>


<div *ngIf="error" class="modal">
  <div class="modal-background">
    <div class="modal-window">

      <div class="modal-body">
        <div class="form-control-container" style="color: red">
          {{errorMessage}}
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn primary" (click)="toggleErrorModal()">OK</button>
      </div>
    </div>
  </div>
</div>

<div *ngIf="activeCard" class="modal">
  <div class="modal-background">
    <div class="modal-window">
      <div class="modal-header">
        <app-inline-input
          [value]="activeCard.name"
          (valueChanged)="handleCardRenamed($event, this.activeCard, this.activeList)"
        ></app-inline-input>
      </div>
      <div class="modal-body">
        <div class="card-section">
          <span>Description</span>
          <div>
            <app-inline-input
              [value]="activeCard.description || 'description...'"
              (valueChanged)="handleDescriptionChanged($event, activeList.id, activeCard.id, data.id)"
            ></app-inline-input>
          </div>
        </div>
        <div class="card-section">
          <span>Labels</span>
          <div>
            <app-label *ngFor="let labelId of activeCard.labels" [id]="labelId"></app-label>
            <br>
            <div class="dropdown">
              <button class="btn" (click)="toggleManageLabels()">Manage labels</button>
              <div *ngIf="managingLabels" class="dropdown-content" style="display: block" id="labelDropdown">
                <div *ngIf="activeLabel else labelMenu">
                  <button class="btn" (click)="activeLabel = null">Back</button>
                  <div class="form-control-container">
                    <label for="labelName">
                      Name
                    </label>
                    <input id="labelName" name="labelName" type="text" [(ngModel)]="labelName">
                  </div>
                  <div class="form-control-container">
                    <label for="labelColor">
                      Color
                    </label>
                    <input id="labelColor" name="labelColor" style="min-height: 18px" type="color" [(ngModel)]="labelColor">
                  </div>
                  <button class="btn" (click)="handleLabelEditConfirm(labelName, labelColor)">Confirm</button>
                </div>
                <ng-template #labelMenu>
                  <div *ngFor="let label of data.labels">
                    <app-label  [id]="label.id"></app-label>
                    <button class="btn" *ngIf="isLabelActive(label.id, activeCard)">Detach</button>
                    <button class="btn" *ngIf="!isLabelActive(label.id, activeCard)">Attach</button>
                    <button class="btn" (click)="handleLabelEditClicked(label.id)">Edit</button>
                  </div>
                  <button class="btn" (click)="handleLabelEditClicked(null)">+</button>
                </ng-template>
              </div>
            </div>
          </div>
        </div>
        <div class="card-section">
          <span>Checklist</span>
          <div>
            <button class="btn">Checklist</button>
          </div>
        </div>
        <div class="card-section">
          <span>Date</span>
          <div>
            <button class="btn">Date</button>
          </div>
        </div>
        {{ activeCard.id }}
      </div>
      <div class="modal-footer">
        <button class="btn" (click)="closeCardModal()">Close</button>
        <button type="submit" class="btn primary" (click)="closeCardModal()">Confirm</button>
      </div>
    </div>
  </div>
</div>
